# 5.1 네트워크 계층 개요
## 5.1.1 네트워크 개층 개요
  - 데이터 패킷의 전송 경로를 결정
  - 주요 프로토콜로는 IP(논리적 주소)가 있으며, 패킷의 출발지와 목적지를 식별하게 함
  - 네트워크 내의 여러 라우터를 통한 패킷의 경로를 관리 및 패킷 손실, 중복, 지연 등의 문제 처리
## 5.1.2 Routed Protocol
  - 네트워크 환경에서 라우팅 테이블을 기반으로 데이터 패킷을 전송하는 통신 규약
  - 예시) IP, IPv6, IPX, Apple Talk 등
  - 이러한 프로토콜 등은 호스트 간의 통신을 가능하게 하며, 라우터는 이 프로토콜을 사용하여 패킷을 적절한 경로로 전송함
## 5.1.3 Routing Protocol
  - 네트워크 연결 정보를 공유하여 라우팅 테이블을 구축하고 유지하는 프로토콜
  - 라우터는 Routing Protocol을 통해 서로 연결 정보를 교환하고, 이를 바탕으로 최적의 경로를 계산하여 라우팅 테이블을 업데이트함
  - 예시) OSPF, RIP, BGP
# 5.2 주요 장비
(추후 설명)

# 5.3 IP 주소
## 5.3.1 IP (Internet Protocol)
  - 네트워크 계층에서 프로토콜로, 두 장치 간의 패킷 전송을 담당함
  - IP 주소는 각 네트워크에 연결된 장치를 고유하게 식별하는데 사용되며, 이 주소를 기반으로 데이터 패킷이 목적지까지 전달됨
  - 사용자가 변경 가능한 논리 주소
  - 그룹을 의미하는 네트워크 주소와 호스트 주소로 나뉨
### 네트워크 주소 & 브로드캐스트 주소
  - IP 주소에는 사용할 수 없는 2가지 주소가 있음
  - 가장 첫 번째 호스트 주소는 네트워크 자체를 지칭, 가장 마지막 주소는 브로드캐스트용 주소로 사용
## 5.3.2 IP 클래스
  - 네트워크 규모에 따라 A~E 클래스로 나뉘어 있음
  - IPv4의 IP주소는 32 Bit이며, 네트워크 크기는 클래스로 구분
### 특수 네트워크 대역
## 5.3.3. 서브넷 (Subnet)
  - IP 주소에서 네트워크 영역을 부분적으로 세분화한 네트워크를 의미
  - 서브넷을 만들 때 사용되는 것이 서브넷 마스크
### 서브넷 마스크 (Subnet Mask)
  - IP 주소 체계의 네트워크 주소(Network ID)와 호스트 주소(Host ID)를 분리하는 역할을 함
  - IP 주소와 동일한 형식을 가지며, 네트워크 부분에는 모두 1이, 호스트 부분에는 모두 0이 할당됨
### 서브넷팅 (Subnetting)
  - 네트워크를 더 작고 효율적인 부분으로 나누는 프로세스.
  - 대형 네트워크를 여러 개의 작은 네트워크, 서브넷으로 분할함으로써 IP 주소 공간을 더 효율적으로 사용할 수 있음
  - 서브넷팅한 네트워크 부분을 확인할 때는 IP 주소와 서브넷 마스크를 AND 연산해서 구함.
  - IP 주소를 2진수로, 서브 마스크를 2진수로 표현함
  - 호스트 부분을 모두 1로 변경하여 브로드캐스트 주소를 알아냄
  - 사용 가능한 IP 주소 범위를 파악함. 서브넷팅한 네트워크 주소 +1은 사용 가능한 가장 작은 IP 주소, 브로드캐스트 주소 -1은 사용 가능한 가장 큰 IP 주소
### CIDR (Classless Inter-Domain Routing)
  - 클래스 기반 네트워킹을 대체하기 위해 개발된 방식으로, 더욱 유연한 IP 주소 할당을 가능하게 함
  - 슬래시(/) 뒤에 숫자를 사용하여 네트워크 부분의 비트 수를 나타냄. 이 비트 수는 해당 네트워크에서 호스트를 구분하는데 사용됨
### VLSM (Variable Length Subnet Masking)
  - 서브넷 마스크의 길이를 가변적으로 조정하여 IP 주소 공간을 효율적으로 사용할 수 있게 하는 기술.
  - 필요에 따라 다양한 크기에 서브넷 생성 가능
  <-> FLSM

## 5.3.4 공인 IP
  - ISP가 제공하는 IP (= 공용 IP, 외부 IP)
  - 외부 망에 공개되어 있는 IP, 세상에서 단 하나뿐인 IP주소기 때문에 같은 주소가 동시에 존재할 수 없음
  - 인터넷 망에서 서로 다른 PC가 통신하기 위해 필요함
  - 공인 IP를 가진 기기는 인터넷 상에 노출되며, 대략적인 지리 위치를 추적할 수 있음

## 5.3.5 사설 IP
  - 가정이나 회사 등의 내부망에서 사용되는 IP (= 내부 IP)
  - 외부 망에 공개되어 있지 않은 IP, 수많은 중복 주소가 동시에 존재할 수 있음
  - PC를 특정할 수 없기 때문에 인터넷 망에서 다른 PC와 통신하는 데 사용할 수 없음
  - 같은 내부망에 존재하는 다른 PC와 통신은 가능
  - 외부망에서 내부망의 PC로 접근하기 위해서는 포트 포워딩과 같은 설정이 필요
  - 공유기에 연결된 PC가 인터넷에 접속할 때, 사설 IP가 아닌 공인 IP를 사용

## 5.3.6 NAT (Network Address Translation)
  - 사설 IP를 공인 IP로 변경할 때 사용되며, 여러 노드 하나의 공인 IP 주소를 공유하여 인터넷에 접속할 수 있도록 해줌
  - 하나의 공인 IP에 여러 개의 사설 IP를 부여하여 IP 주소 공간의 부족 문제를 완화하는데 도움을 줌
  - 외부 네트워크에서 직접 사설 네트워크 내의 특정 장비를 찾아 접근하는 것을 방지하여 네트워크의 보안을 향상시킴

# 5.4 IP 프로토콜
## IP 헤더
  - ```Version```: IP 프로토콜 버전 (IPv4 / IPv6)
  - ```IHL (Internet Header Length)```: IP 헤더의 길이. 이 값에 따라 옵션 필드의 유무와 길이를 알 수 있음
  - ```TOS (Type of Service)```: 패킷 처리의 우선 순위 결정
  - ```Total Length```: IP 헤더와 데이터를 포함한 전체 패킷의 길이
  - ```Identification```: 패킷을 구분하기 위한 고유 번호. 패킷이 분할되었을 때, 각 조각을 다시 원래의 패킷으로 조립하는데 사용
  - ```Flags```: 패킷의 분할 가능 여부와 분할된 패킷의 마지막 조각인지 여부 표시
  - ```Fragment Offset```: 분할된 패킷의 순서
  - ```TTL (Time to Live)```: 패킷이 네트워크에서 살아있을 수 있는 시간. 패킷이 라우터를 통과할 때마다 1씩 감소, 0이 되면 패킷이 폐기. 보통 윈도우에서는 128, 리눅스에서는 64
  - ```Protocol```: IP 데이터 필드에서 사용 프로토콜
  - ```Header Checksum```: IP 헤더의 오류 검출
  - ```Source IP Address```: 패킷을 보낸 호스트의 IP 주소
  - ```Options```: 필요에 따라 추가할 수 있는 옵션 정보. 선택 사항이며 실제로는 거의 사용하지 않음

## 5.5 ARP 프로토콜
## 5.5.1 ARP (Address Resolution Protocol)
  - 데이터 통신을 위해 물리적 주소인 MAC 주소와 논리적 IP 주소 두 개가 사용됨
  - 두 개의 주소를 연계시켜주기 위한 메커니즘이 필요 => ARP
  - 윈도우 cmd에서 ```arp -a``` 명령을 입력하면 PC의 ARP 테이블 정보 확인 가능
## 5.5.2 ARP Header
  - ```Hardware Type```: 사용중인 하드웨어 주소 타입을 나타내는 필드. 네트워크 유형을 나타냄
  - ```Protocol Type```: 프로토콜 타입 (0x0800은 IPv4를 의미)
  - ```Hardware Address length```: 물리 주소의 길이
  - ```Protocol Address Length```: 프로토콜 주소의 길이
  - ```Operation Code```:
    - Request = 1
  특정 IP 주소에 대한 MAC 주소를 찾기 위한 요청. 이 요청은 네트워크 내의 모든 장치에게 브로드캐스트 되며, 해당 IP주소를 가진 장치는 이 요청에 응답하여 자신의 MAC 주소 제공
    - Request = 2
  요청에 대한 응답으로, 요청받은 IP 주소에 대한 MAC 주소를 포함. 이 응답은 요청을 보낸 장치에게만 전달
  - ```Sender Hardware Address```: ARP 요청을 보낸 호스트의 물리 주소
  - ```Sender Protocol Address```: ARP 요청을 보낸 호스트의 프로토콜 주소
  - ```Target Hardware Address```: ARP 요청의 대상인 호스트의 물리 주소. ARP 요청의 경우, 목적지 시스템의 물리 주소를 알 수 없기에 모두 0으로 설정
  - ```Target Protocol Address```: ARP 요청의 대상인 호스트의 프로토콜 주소
## 5.5.3 RARP (Reverse Address Resolution Protocol)
  - MAC 주소를 기반으로 IP 주소를 찾는 역할을 하는 프로토콜

## 5.5.4 GARP (Gratuitous Address Resolution Protocol)
  - 대상자 IP 필드에 자신의 IP 주소를 채워 ARP 요청을 보냄
  - 자신의 IP와 MAC 주소를 알릴 목적으로 사용
  - 메시지를 보낼 때, 만약 다른 장비에서 응답이 오면 그것은 동일한 IP 주소를 가진 장비가 이미 네트워크에 존재함을 의미하며, 이는 IP 주소 충돌의 가능성을 나타냄
  - 네트워크 내의 다른 장비들이 ARP 테이블을 갱신하게 할 수 있도록 함

  => RARP와 GARP는 DHCP로 대체되어 현재는 잘 사용되지 않음

# 5.6 ICMP 프로토콜 
## 5.6.1 ICMP (Internet Control Message Protocol)
  - 네트워크 장치들이 정보를 교환하거나 오류 메시지를 보내는데 사용 ★
  - 데이터가 의도한 대상에 도달하는지를 확인
  - 일반적으로 라우터와 같은 네트워크 장치에서 사용
  - 대표적인 활용으로는 ```ping```, ```traceroute```, ```tracert``` 등이 있음
  - IPv4 헤더의 Protocol Type이 1이면 ICMP 패킷임을 나타냄 
## 5.6.2 ICMP 헤더
  - ```Type```: 메시지의 유형
  - ```Code```: 메시지의 유형에 대한 추가 정보 제공
  - ```Checksum```: 메시지의 오류를 검출
  - ```Rest of Header```: ICMP 유형 및 코드에 따라 내용이 달라짐
### ICMP Echo Request and Echo Reply Messages (=Ping)
  - ```Type```: ICMP 메시지 유형 (대분류)
  - ```Code```: Echo Request 및 Echo Reply 메시지에 대한 코드 (소분류)
  - ```Checksum```: 메시지의 오류를 검출
  - ```Identifier```: Echo Request와 Echo Reply를 연결하는 식별자
  - ```Sequence Number```: 메시지의 순서 일련번호
  - ```Data```: 메시지에 대한 추가 데이터, 가변 길이의 데이터 표현 가능
  ### ICMP 타입과 코드 필드

# 5.7 IPSec 프로토콜
## 5.7.1 IPSec (Internet Protocol Security)
  - 인터넷을 통한 통신에서 보안을 제공하기 위한 프로토콜 스위트 (Protocol Suite)로, 데이터의 기밀성, 무결성, 인증을 보장하여 안전한 통신을 구축하는데 사용
  - 인터넷 경유 구간에, 일종의 보안 통로인 터널링 형성을 가능하게 하고, 3계층에서 캡슐화에 의해 보안 통로를 제공함
## 5.7.2 VPN (Virtual Private Network)
  - 물리적인 전용선이 아닌 공중망을 이용해 논리적으로 직접 연결한 것처럼 망을 구성하는 기술
  - 인터넷을 통해 안전하고 비공개로 데이터를 전송함
  - 터널링과 암호화 기술을 활용하여 사용자나 조직 간의 안전한 연결을 구축하며, 지리적으로 떨어진 네트워크나 사용자들 간의 안전한 통신을 지원함
### 터널링
  - VPN은 터널링을 통해 안전한 통신 경로를 형성 (IP 헤더가 이중으로 됨)
  - 데이터를 암호화하고 안전한 터널을 통해 전송하는 방식으로, 외부에서는 터널을 통과하는 데이터를 안전하게 보호할 수 있음
  - 현재 가장 많이 사용되는 보안 VPN 프로토콜은 IPSec과 SSL

# 5.8 IPv6
  ## 5.8.1 IPv6
  - 기존 32 Bit의 IPv4 주소가 고갈되는 문제를 해결하기 위하여 개발된 새로운 128비트 체계의 인터넷 프로토콜 주소
  - 16 Bit 단위로 구분하며, 각 단위는 16진수로 변환되어 콜론(:)으로 구분함
  - 128 비트의 IPv6 주소에서 앞의 64 Bit는 네트워크 주소를, 뒤의 64 Bit는 네트워크에 연결된 통신장비 등에 할당되는 인터페이스 주소를 의미
  ## 5.8.2 IPv6 헤더
  - ```Version```: 버전 정보
  - ```Traffic Class```: 혼잡되는 트래픽 패킷의 우선순위
  - ```Flow Label```: 데이터의 특정한 흐름을 위한 특별한 처리를 제공
  - ```Payload Length```: 기본 헤더를 제외한 IP 데이터 그램 길이
  - ```Next Header```: 기본 헤더 다음에 위치하는 확장 헤더의 종류. IPv4의 프로토콜 번호와 같은 역할
  - ```Hop Limit```: IPv4의 TTL과 같은 역할
  - ```Source Address```: 출발지 주소
  - ```Destination Addrees```: 목적지 주소
  ## 5.8.3 멀티캐스트 어드레싱
  - IPv4 멀티캐스트와 공통된 특징과 프로토콜을 가지고 있으면서도, 특정 프로토콜이 필요하지 않도록 변경과 개선을 제공함
  - 기존의 IP 브로드캐스트를 사용하여 첨부된 링크의 모든 호스트에 패킷을 전송하는 것을 구현하지 않으므로 브로드캐스트 주소를 정의하지 않음
  ## 5.8.4 SLAAC (Stateless Address Autoconfiguration)
  - IPv6 네트워크에서 호스트가 자동으로 IPv6 주소를 구성하는 기술
  ### RA (Router Advertisement)
  - 네트워크의 라우터는 일정한 간격으로 RA 메시지를 전송함
  - 메시지는 네트워크에 존재하는 IPv6 라우터의 존재를 알리고, 네트워크 구성을 위한 정보를 제공함
  - RA 메시지에는 프리픽스(Prefix) 정보와 다양한 구성 옵션들이 포함됨
  ### Prefix
  - 네트워크의 일부를 식별하는데 사용되는 비트의 연속
  - 호스트는 프리픽스 정보를 바탕으로 자신의 IPv6 주소를 구성함
  ### Interface Identifier
  - 호스트는 받은 프리픽스 정보와 자신의 인터페이스 식별자를 조합하여 IPv6 주소를 구성함
  - 인터페이스 식별자는 일반적으로 MAC 주소를 기반으로 생성됨. MAC 주소의 일부 비트를 조정하여 유일한 인터페이스 식별자를 생성함
  ## 5.8.5 DHCPv6 (Dynamic Host Configuration Protocol for IPv6)
  - IPv6 네트워크에서 호스트에게 IPv6 주소 및 다양한 구성 정보를 동적으로 제공하는 프로토콜

# 5.9 라우팅 프로토콜
  ## 5.9.1 AS (Autonomous System)
  - 인터넷에서 라우팅을 관리하는 독립적인 네트워크 시스템
  - AS는 하나 이상의 IP 주소 범위와 함께 라우터들로 구성되어 있으며, 이 독립된 시스템은 자체적으로 관리되며, BGP를 사용하여 다른 AS와 통신함
  - 주로 ISP, 대학교, 대기업 등에서 활용
  - ASN(식별 넘버)
  - 대등 접속 (Peering), 트랜싯 (Transit) 
  ## 5.9.2 IGP (Interior Gateway Protocol)
  - 라우터들이 네트워크의 최적 경로를 계산하고, 라우팅 정보를 교환하는데 사용됨
  - 주로 Distance Vector와 Link State 방식을 사용
  ## 5.9.3 Distance Vector
  - 라우터가 자신의 라우팅 테이블을 이웃 라우터와 주기적으로 공유하는 방식
  - 네트워크의 변화에 빠르게 적응하지만, 라우팅 루프와 같은 문제를 야기할 수 있음
  - 대표적인 예시로는 RIP
  ```거리 벡터 알고리즘: 거리와 방향 정보를 기반으로 최적의 경로 결정```
  ### Distance Vector - RIP (Routing Information Protocol)
  - Distance Vector 방식을 사용하는 라우팅 프로토콜로, 최대 15홉까지의 네트워크를 지원함
  - 간단하고 구현이 쉽지만 큰 네트워크에는 적합하지 않고, 최근에는 잘 사용하지 않음
  ## 5.9.4 Link State
  - 라우터가 네트워크의 전체 지도를 만들고, 이를 바탕으로 최적의 경로를 계산하는 방식
  - 네트워크의 변화를 정확하게 반영하며, 라우팅 루프 문제를 해결함
  - 대표적인 예시로는 OSPF
  ### Link State - OSPF
  - 대형 네트워크를 지원하며 복잡한 토폴로지에 적응할 수 있음
  - 링크 상태 데이터베이스를 사용하여 네트워크의 전체 지도를 만들고, 이를 바탕으로 최적의 경로를 계산
  - 다익스트라(Dijkstra) 알고리즘 사용
  ## 5.9.5 EGP (Exterior Gateway Protocol)
  - AS 간 사용디는 라우팅 프로토콜
  - AS 간의 연결성을 유지하고, 최적의 경로를 선택하는데 사용됨
  - 대표적인 EGP 프로토콜로는 BGP
  ### BGP
  - 서로 다른 AS 간에 라우팅 정보를 교환하는데 사용되는 프로토콜
  - 인터넷의 주요 라우팅 프로토콜로, 각 AS가 자체적으로 결정한 정책에 따라 라우팅 결정을 내릴 수 있게 함