# 6.1 전송 계층 개요
## 6.1.1 전송 계층 개요
  - 전송 계층이 데이터를 전달받아 이를 세그먼트로 분할하고, 이를 목적지까지 안전하게 전송하는 역할
  - 통신 세션을 관리, 에러 복구와 흐름 제어 기능 담당
  - 대표적인 전송 계층의 프로토콜로는 TCP(Transmission Control Protocol), UDP(User Datagram Protocol)
## 6.1.2 통신 방법
  ### 연결형 통신
  - 통신을 시작하기 전에 논리적인 연결을 설정하고, 데이터를 전송한 후에는 명시적으로 연결을 해제하는 방식
  - TCP와 같은 프로토콜에서 사용되며, 데이터의 신뢰성을 보장하고 순서를 유지
  ### 비연결형 통신
  - 통신을 시작하기 전에 논리적인 연결을 설정하지 않고, 각각의 데이터 패킷을 독립적으로 전송하는 방식의 통신
  - UDP와 같은 프로토콜에서 사용되며, 간단하고 빠른 전송 지향
  ### 신뢰성 제어 - 흐름 제어
  - 수신자와 송신자 간의 데이터 전송 속도를 조절하여 데이터의 넘침을 방지하는 제어 메커니즘
  - 연결형 통신에서 주로 사용되며, TCP에서 윈도우 크기(Window Size) 등을 조절하여 구현됨
  - 수신자는 자신이 처리할 수 있는 데이터량(버퍼)을 송신자에게 알려줌 
  ### 신뢰성 제어 - 혼잡 제어
  - 네트워크 내에서 혼잡이 발생하지 않도록 데이터의 전송 속도를 동적으로 조절하는 제어 메커니즘
  - 네트워크 내의 혼잡 상태를 감지하고, 혼잡이 발생하면 전송 속도를 줄이거나 중지하며 조절함
  - 혼잡이 완화되면 다시 전송 속도를 증가시킴

# 6.2 포트 주소 ★
## 6.2.1 포트
  - 네트워크 상에서 통신을 하기 위해 컴퓨터나 기타 네트워크 장치 내에서 특정 프로세스나 서비스를 식별하는데 사용되는 고유한 번호
  ```프로세스: 실행중인 프로그램```
  - 이를 통해 데이터는 올바른 위치로 전송될 수 있으며, TCP / IP에서는 0부터 65535까지 총 65536개의 포트가 있음
  ### 잘 알려진 포트
  - 0 ~ 1023번 포트를 Well-Known Ports라고 함
  - 이 범위의 포트 번호는 특정한 서비스를 위해 예약되어 있음
  - HTTP: 80, HTTPS: 443, SSH: 22
  ### 등록된 포트
  - 1024 ~ 49151번 포트를 Resistered Ports라고 함
  - 이 범위의 포트는 특정한 애플리케이션에서 사용하기 위해 IANA (Internet Assigned Numbers Authority)에 등록하여 사용할 수 있음
  ### 동적 포트
  - 49152 ~ 65535번 포트를 Dynamic Ports라고 함
  - 이 범위의 포트는 일반적은 애플리케이션에서 동적으로 사용하며, 특별히 예약되어 있지 않음

# 6.3 TCP 프로토콜
## 6.3.1 TCP
  - 네트워크 상에서 데이터를 안정적으로 전송하기 위한 프로토콜 중 하나. TCP는 신뢰성 있는 연결을 제공하며, 데이터의 순서를 보장하고 오류 복구를 수행
  - TCP는 세계 통신 표준으로 개발된 OSI 모형에서 4번째 계층인 전송 계층에서 사용하는 프로토콜로, 보통 네트워크 계층의 IP와 엮어 TCP/IP로 표현함
  - 하나의 송신 측과 하나의 수신 측이 통신하는 1:1 통신 (Point-to-Point)
### 3-Way Handshake
  - 연결(connection)은 SYN(연결 요청)과 ACK(확인 응답)를 사용하여 확립할 수 있고, 신뢰할 수 있는 연결을 하려면 데이터를 전송하기 전에 패킷 교환을 세 번 확인함
  #### 과정
  - **클라이언트가 서버에 연결 요청 (SYN)**
    - 클라이언트가 초기 시퀀스 번호(seq = 0)를 갖는 ```SYN``` 패킷을 보냄
    - 서버는 ```SYN + ACK``` 패킷으로 응답하고 초기 시퀀스 번호를 알려줌
  - **클라이언트가 응답 및 데이터 요청 (ACK 및 HTTP 요청)**
    - 클라이언트가 ```ACK``` 패킷을 보내고, HTTP ```GET``` 요청을 서버로 전송
    - 클라이언트의 ACK 패킷에는 초기 시퀀스 번호, 확인 응답 번호가 포함됨
  - **서버가 응답 및 데이터 전송 (ACK 및 HTTP 응답)**
    - 서버가 클라이언트에게 ```ACK``` 패킷으로 응답하고, ```HTTP``` 응답을 클라이언트로 전송
    - 서버의 ACK 패킷에는 초기 시퀀스 번호, 확인 응답 번호가 포힘됨
  - **클라이언트가 서버의 응답 확인 (ACK)**
    - 클라이언트가 서버의 ```HTTP``` 응답에 대한 확인으로 ```ACK``` 패킷을 보냄
    - 클라이언트의 ACK 패킷에는 초기 시퀀스 번호, 확인 응답 번호가 포함됨

## 6.3.2 TCP 헤더
  - ```Source Port```: 송신자의 포트 번호
  - ```Destination Port```: 수신자의 포트 번호
  - ```Sequence Number```: 세그먼트 데이터 조각이 전체 데이터 스트림 어디에 위치하는지 식별
  - ```Acknowledgement number```: 수신자가 받은 데이터의 일련번호를 응답함으로써 송신자에게 어떤 데이터까지 받았는지 알려줌
  - ```Data Offset```: 헤더의 길이를 32비트 워드 단위로 나타냄
  - ```Flags```: 세그먼트의 제어 정보
    - ```CWR (Congestion Window Reduced)```: 송신 호스트가 TCP 세그먼트를 수신하고 이에 대한 혼잡 제어 메커니즘 응답을 했음을 나타내는 플래그
    - ```ECE (ECN-Echo)```:
      - SYN 플래그가 설정된 경우 (1): TCP 피어가 ECN(ECN-Capable Transport)을 지원함을 나타냄
      - SYN 플래그가 해제된 경우 (0): IP 헤더의 Congestion Experienced 플래그가 설정된 패킷이 정상 전송 중에 수신되었음을 나타냄. 이는 TCP 송신자에게 네트워크 혼잡을 나타냄
    - ```URG (URG)```: Urgent pointer 필드가 의미있음을 나타냄
    - ```ACK (Acknowledgement)```: 수신 확인 번호가 유효함을 나타냄
    - ```PSH (Push)```: 버퍼된 데이터를 즉시 수신 애플리케이션으로 전송하도록 요청하는 플래그
    - ```RST (Reset)```: 연결을 초기화하거나 연결 오류를 나타냄
    - ```SYN (Synchronize)```: 일련번호를 동기화함을 나타냄. 양쪽에서 보내는 첫 번째 패킷만 이 플래그를 설정해야 함
    - ```FIN (Finish)```: 송신자로부터의 마지막 패킷을 나타냄
  - ```Window Size```
    - 수신자가 현재 받을 수 있는 데이터의 양을 나타내는 값으로, 흐름 제어에 사용
    - 매번 확인 응답을 기다리는 대신 세그먼트를 연속해서 보내고 난 다음에 확인 응답을 반환하면 효율이 높아지지만 상대방에는 세그먼트가 점점 쌓임
    - 상대방에게 쌓인 세그먼트는 버퍼(buffer)라는 장소에 일시적으로 보관
    - 버퍼 덕분에 세그먼트를 연속으로 보내도 수신 측은 대응할 수 있고 효율도 높아짐
    - 수신 측은 대량으로 데이터가 전송되면 보관하지 못하고 넘쳐버리는 경우를 오버플로(overflow)라고 함
  - ```Checksum```: 세그먼트의 오류를 검출하기 위한 체크섬 값이 포함됨
  - ```Urgent Pointer```: URG 플래그가 설정된 경우 이 16 비트 필드는 마지막 긴급 데이터 바이트를 나타내는 시퀀스 번호에서 오프셋됨
  - ```Options```: TCP 헤더의 Options 필드는 최대 320 비트까지 가변 길이로, 데이터 오프셋 필드에 의해 결정됨

# 6.4 UDP 프로토콜
## 6.4.1 UDP (User Datagram Protocol)
  - 비연결형, 신뢰성이 없는 전송 프로토콜
  - 흐름 제어, 오류 제어 또는 손상된 세그먼트의 수신에 대한 재전송을 하지 않음
  - 따라서 내용이 전송 중에 손실될 수 있고, 전송 되는 세그먼트의 순서가 바뀔 수 있음
  - 흐름 제어를 하지 않기 때문에 전송 속도가 TCP보다 간단하고 빠름
## 6.4.2 UDP 헤더
  - ```Source Port```: 패킷이 어디서 왔는지 식별
  - ```Destination Port```: 패킷을 어디로 보낼 지 식별
  - ```Length```: UDP 헤더와 데이터의 전체 길이
  - ```Checksum```: 데이터그램의 오류 검출
